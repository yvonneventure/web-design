# Data Visualization with D3.js

D3, or D3.js, stands for Data Driven Documents. It's a JavaScript library for creating dynamic and interactive data visualizations in the browser.

D3 is built to work with common web standards â€“ namely HTML, CSS, and Scalable Vector Graphics (SVG).

D3 supports many different kinds of input data formats. Then, using its powerful built-in methods, you can transform those data into different charts, graphs, and maps.


### Add Document Elements with D3

- `select()` method

`select()` method takes an argument for the name of the element you want and returns an HTML node for the first element in the document that matches the name. 

```js
const anchor = d3.select("a");
```

- `append()` and `text()`

The `append()` method takes an argument for the element you want to add to the document. It appends an HTML node to a selected item, and returns a handle to that node.

The `text()` method either sets the text of the selected node, or gets the current text. To set the value, you pass a string as an argument inside the parentheses of the method.

Here's an example that selects an unordered list, appends a list item, and adds text:

```html
<body>
  <script>
d3.select("ul")
  .append("li")
  .text("Very important item");
  
<body>
  <script>
```

- `selectAll()`

`selectAll()` method select a group of elements. It returns an **array** of HTML nodes for all the items in the document that match the input string.

Select all of the li tags in the document, and change their text to the string "list item".

```html
<body>
  <ul>
    <li>Example</li>
    <li>Example</li>
    <li>Example</li>
  </ul>
  <script>
    d3.selectAll("li").text("list item")
  </script>
</body>
```

### Work with Data

The D3 library focuses on a data-driven approach. When you have a set of data, you can apply D3 methods to display it on the page. 

The first step is to make D3 aware of the data. The `data()` method is used on a selection of DOM elements to attach the data to those elements. The data set is passed as an argument to the method.

A common workflow pattern is to create a new element in the document for each piece of data in the set. D3 has the `enter()` method for this purpose.

When `enter()` is combined with the `data()` method, it looks at the selected elements from the page and compares them to the number of data items in the set. If there are fewer elements than data items, it creates the missing elements.

Here is an example that selects a `ul` element and creates a new list item based on the number of entries in the array:

```html
<body>
  <ul></ul>
  <script>
    const dataset = ["a", "b", "c"];
    d3.select("ul").selectAll("li")
      .data(dataset)
      .enter()
      .append("li")
      .text("New item");
  </script>
</body>
```

It may seem confusing to select elements that don't exist yet. This code is telling D3 to first select the `ul` on the page. Next, select all list items, which returns an empty selection. Then the `data()` method reviews the `dataset` variable and runs the following code three times, once for each item in the array. The `enter(`) method sees there are no `li` elements on the page, but it needs 3 (one for each piece of data in `dataset`). New `li` elements are appended to the `ul` and have the text "New item".

#### - Work with Dynamic Data in D3

The D3 `text()` method can take a string or a callback function as an argument. The parameter `d` refers to a single entry in the dataset that a selection is bound to.

Using the current example as context, the first h2 element is bound to 12, the second h2 element is bound to 31, the third h2 element is bound to 22, and so on.

```html
<body>
  <script>
    const dataset = [12, 31, 22, 17, 25, 18, 29, 14, 9];
    
    d3.select("body").selectAll("h2")
      .data(dataset)
      .enter()
      .append("h2")
      // d here is each element in dataset
      .text((d) => d + ' USD');
      
  </script>
</body> 

```

### Add Inline Styling to Elements


The style() method lets you add inline CSS styles on dynamic elements. It takes a comma-separated key-value pair as an argument. Here's an example to set the selection's text color to blue:

```js
selection.style("color","blue");
```

Another example:

```html
<body>
  <script>
    const dataset = [12, 31, 22, 17, 25, 18, 29, 14, 9];
    
    d3.select("body").selectAll("h2")
      .data(dataset)
      .enter()
      .append("h2")
      .text((d) => (d + " USD"))
      
      .style('font-family', 'verdana')
      
  </script>
</body>   
```

#### - Change Styles Based on Data

You can use a callback function in the `style()` method to change the styling for different elements.

```html
<body>
  <script>
    const dataset = [12, 31, 22, 17, 25, 18, 29, 14, 9];

    d3.select("body").selectAll("h2")
      .data(dataset)
      .enter()
      .append("h2")
      .text((d) => (d + " USD"))
     //if data<20, color red, else green
  .style("color", (d) => {
        if (d < 20){
          return 'red'
        }
        else {
          return 'green'
        }
      })


      // Add your code above this line
  </script>
</body>
```

### Add Classes

Using a lot of inline styles on HTML elements gets hard to manage, even for smaller apps. It's easier to add a class to elements and style that class one time using CSS rules.

D3 has the `attr()` method to add any HTML attribute to an element, including a class name.

The `attr()` method takes comma-separated values, and can use a callback function. Here's an example to add a class of "bar" to a selection:

```js
d3.select("body").selectAll("div")
      .data(dataset)
      .enter()
      .append("div")
      // add class name "bar"
      .attr('class', 'bar')
```

### Update the Height of an Element Dynamically

There are two steps to create a simple bar chart:

1. Create a `div` for each data point in the array
2. Give each `div` a dynamic height, using a callback function in the `style()` method that sets height equal to the data value


Recall the format to set a style using a callback function `selection.style("cssProperty", (d) => d)`

```html
<style>
  .bar {
    width: 25px;
    height: 100px;
    display: inline-block;
    background-color: blue;
  }
</style>
<body>
  <script>
    const dataset = [12, 31, 22, 17, 25, 18, 29, 14, 9];
    d3.select("body").selectAll("div")
      .data(dataset)
      .enter()
      .append("div")
      .attr("class", "bar")
      .style('height', d => `${d}px`)
  </script>
</body>
```































































